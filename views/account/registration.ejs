<div class="account-form-container"> 
    <h1 class="page-heading"><%= title %></h1>
    <p>All fields are <span class="required">*</span> required.</p>

    <!-- Display Flash Messages (Checking for general messages) -->
    <% 
        let allMessages = [];
        if (typeof messages === 'object' && messages !== null) {
            Object.keys(messages).forEach(key => {
                if (Array.isArray(messages[key])) {
                    allMessages = allMessages.concat(messages[key]);
                }
            });
        }
    %>
    <% if (allMessages.length > 0) { %>
        <ul class="notice success-notice" role="alert">
            <% allMessages.forEach(message => { %>
                <li><%= message %></li>
            <% }); %>
        </ul>
    <% } %>

    <!-- DISPLAY SERVER-SIDE VALIDATION ERRORS -->
    <% if (errors) { %>
        <ul class="notice error-notice">
            <% errors.array().forEach(error => { %>
                <li><%= error.msg %></li>
            <% }) %>
        </ul>
    <% } %>

    <form action="/account/register" method="post">
        <label for="accountFirstname">First Name: <span class="required">*</span></label>
        <input
            type="text"
            name="account_firstname"
            id="accountFirstname"
            required
            value="<%= typeof locals.account_firstname !== 'undefined' ? locals.account_firstname : '' %>"
        />

        <label for="accountLastname">Last Name: <span class="required">*</span></label>
        <input
            type="text"
            name="account_lastname"
            id="accountLastname"
            required
            value="<%= typeof locals.account_lastname !== 'undefined' ? locals.account_lastname : '' %>"
        />

        <label for="accountEmail">Email: <span class="required">*</span></label>
        <input
            type="email"
            name="account_email"
            id="accountEmail"
            required
            value="<%= typeof locals.account_email !== 'undefined' ? locals.account_email : '' %>"
        />

        <label for="account_password">
            Password: <span class="required">*</span>
            <span class="password-requirements">
                Must be at least 12 characters, include 1 capital letter, 1 number, and 1 special character.
            </span>
        </label>
        <input
            type="password"
            id="account_password"
            name="account_password"
            required
            minlength="12"
            autocomplete="new-password"
        />
        <button
            type="button"
            class="toggle-password"
            onclick="togglePassword()"
        >
            Show/Hide Password
        </button>

        <!-- Using the 'button' class for styling, setting width to 100% inside the form -->
        <button type="submit" class="button" style="width: 100%;">Register</button>
    </form>
</div>

<script>
    function togglePassword() {
        const pwd = document.getElementById("account_password");
        pwd.type = pwd.type === "password" ? "text" : "password";
    }
</script>
